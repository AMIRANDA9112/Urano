{% extends 'feed/base.html' %}
{% load humanize %}
{%block content%}

  <section class = "flex justify-center text-gray-100">
    <div class = "">
      <div class = "py-8">
        <img class="rounded"
                src="{{ user.profile.image.url }}"
                alt = "Generic placeholder image"
                width= "250"
                height= "250">
      </div>

      <h3 class="text-center text-4xl font-bold">{{user.username}}</h3>

    </div>

  </section>

  <div class="grid grid-cols-1 justify-items-center space-y-2 w-full text-gray-100">
    <div class="grid grid-cols-1 text-center space-y-6">

          <div class="max-w-md text-justify py-8">

            {{user.profile.bio}}

          </div>

            {%if user == request.user%}

            <a href="{% url 'settings' %}"><button class = "text-center hover:bg-gray-500 bg-gray-800
                               py-2 px-4 rounded"><i class="fa fa-cogs fa-3x text-gray-100"></i></button></a>


            {% endif %}

    </div>
  {% for publication in publications %}

        <section class = " shadow grid grid-cols-1 justify-center justify-items-center bg-gray-900 text-gray-100 my-4 md:w-2/5 w-full">



            <div class = "grid grid-cols-1 w-11/12">
                <div class = "grid grid-cols-2 pt-8 py-8">
                    <div class = "pr-8 ">


                        <button class="outline-none focus:outline-none" type="button" onclick="openPopover(event,'{{publication.id}}')">
                            <img href="{% url 'profile' publication.uname %}" class="rounded shadow hover:shadow-lg"
                            src="{{ publication.uname.profile.image.url }}"
                            width= "50"
                            height= "50"></button>

                             <a class ="transform hover:text-gray-600 text-sm" href="{% url 'profile' publication.uname %}">
                                <h4>{{publication.uname}}</h4></a>

                        <div class="grid grid-cols-1 max-w-max  hidden font-normal leading-normal md:text-sm text-xs text-left no-underline break-words rounded-lg shadow" id="{{publication.id}}">
                            <div>
                                <img href="{% url 'profile' publication.uname %}" class="rounded"
                                src="{{ publication.uname.profile.image.url }}"
                                width= "250"
                                height= "250">
                            </div>
                            <div class="bg-gray-900 text-gray-100 p-3 rounded">
                                  {{publication.uname.profile.bio}}
                            </div>
                        </div>
                    </div>
                    <div class="text-right px-2">
                        <a href="{% url 'publicationdetail' publication.pk %}" class = "font-serif text-xs">
                            {{publication.datatime|naturaltime}}</a> <br>

                        <a class="text-xs" style="color:#67E8F9" href="{% url 'publicationdetail' publication.pk %}">
                            <i class="fa fa-thumbs-up" ></i>{{publication.likes.all.count}}</a>


                        <a class="text-xs text-red-300" href="{% url 'publicationdetail' publication.pk %}">
                            <i class="fa fa-thumbs-down  "></i>{{publication.dislikes.all.count}}</a>
                    </div>

                </div>

            <div class="grid grid-cols-1 ">
                <div class="grid grid-cols-1">
                    <p class="text-left break-words md:text-sm text-xs">{{publication.tag_text|safe}}</p>

                </div>

                  {% if publication.video %}

                <div class="">

                      <video
                        id="my-videow"
                        class="video-js vjs-default-skin vjs-big-play-centered w-full"
                        controls = "True"
                        preload="auto"
                        width = "480"
                        height="240"


                        data-setup="{}">
                        <source src="{{ publication.video.url }}" />

                      </video>
                </div>
                {% elif publication.img %}
                <div class="place-self-center">
                    <img
                        class = "max-h-72 max-w-full "
                        src="{{ publication.img.url }}">
                </div>
                {% elif publication.img2 %}
                <div class="place-self-center">

                    <img
                        class = "max-h-72 max-w-full "
                        src="{{ publication.img2.url }}">
                </div>
                     {% elif publication.pdf %}

                <div class="text-center text-lg font-bold text-yellow-300 py-4 ">

                    <a class="justify-self-center" href="{{publication.pdf.url}}">Documento PDF Adjunto <br> &#128196</a>
                </div>

                    {% else %}
                <div class="">

                     {{map|safe}}

                </div>

                    {% endif %}

                <div class="text-gray-100 ">

                    {% for tag in publication.tags.all %}

                    <a href="{% url 'publicationtags' tag.slug %}" class = " md:text-sm text-xs" style="color:#67E8F9"> {{tag.name}}</a>
                    {% endfor %}

                </div>
                <div class="grid grid-cols-1 text-gray-100">
                    <div class="text-center">

                        {% if publication.img %}

                        <a href="{% url 'publicationdetail' publication.pk %}"> <i class="fa fa-file-image-o" style="color:#67E8F9"></i> </a>
                        {% endif %}
                        {% if publication.img2 %}
                        <a href="{% url 'publicationdetail' publication.pk %}"> <i class="fa fa-file-image-o" style="color:#67E8F9"></i> </a>

                        {% endif %}
                        {% if publication.video %}
                        <a href="{% url 'publicationdetail' publication.pk %}"> <i class="fa fa-file-video-o" style="color:#67E8F9"></i> </a>
                        {% endif %}
                        {% if publication.pdf %}
                        <a href="{% url 'publicationdetail' publication.pk %}"> <i class="fa fa-file-pdf-o" style="color:#67E8F9"></i> </a>
                        {% endif %}
                    </div>
                </div>
                {%if publication.uname == request.user%}

                <div class="grid grid-cols-2 align-text-bottom">

                    <div class="text-right justify-self-end pr-4 w-8 text-gray-300" >
                        <a href="{% url 'publicationupdate' publication.id %}">
                            <i class="fa fa-pencil-square-o  "></i>
                        </a>
                    </div>
                    <div class=" text-left justify-self-start pl-4 w-8 text-gray-300">

                        <a href="{% url 'publicationdelete' publication.id %}">
                            <i class="fa fa-trash "></i>
                        </a>
                    </div>
                </div>
                {% endif %}

            </div>
        </div>
    </section>
    {% endfor %}

    {% for publication, map in publicationsw %}

        <section class = "shadow flex justify-center bg-gray-900 text-gray-100 my-4 md:w-2/5 w-full">
            <div class = "grid grid-cols-1 w-11/12">
                 <div class = "grid grid-cols-2 pt-8 py-8">
                    <div class = "pr-8 ">

                        <button class="outline-none focus:outline-none" type="button" onclick="openPopover(event,'{{publication.id}}')">
                            <img href="{% url 'profile' publication.uname %}" class="rounded shadow hover:shadow-lg"
                            src="{{ publication.uname.profile.image.url }}"
                            width= "50"
                            height= "50"></button>

                            <a class ="transform hover:text-gray-600 text-sm" href="{% url 'profile' publication.uname %}">
                            <h4>{{publication.uname}}</h4></a>

                        <div class="grid grid-cols-1 max-w-max  hidden font-normal leading-normal md:text-sm text-xs   text-left no-underline break-words rounded-lg shadow" id="{{publication.id}}">
                          <div>
                            <img href="{% url 'profile' publication.uname %}" class="rounded"
                            src="{{ publication.uname.profile.image.url }}"
                            width= "250"
                            height= "250">
                            </div>
                            <div class="bg-gray-900 text-gray-100 p-3 rounded">
                              {{publication.uname.profile.bio}}
                            </div>

                        </div>




                    </div>
                    <div class="text-right px-2">
                        <a href="{% url 'publicationwdetail' publication.pk %}"><h1 class="text-md text-yellow-200 capitalize">{{publication.case_id}}</h1></a>
                        <a href="{% url 'publicationwdetail' publication.pk %}"
                           class = "font-serif  text-xs">{{publication.datatime|naturaltime}}</a><br>

                           <a class="text-xs" style="color:#67E8F9" href="{% url 'publicationwdetail' publication.pk %}"><i class="fa fa-thumbs-up" ></i>{{publication.likes.all.count}}</a>


                        <a class="text-xs text-red-300" href="{% url 'publicationwdetail' publication.pk %}"><i class="fa fa-thumbs-down  "></i>{{publication.dislikes.all.count}}</a>


                    </div>

                </div>

                <div class="grid grid-cols-1">

                    <p class="text-left break-words text-xs">{{publication.tag_text|safe}}</p>

                </div>




                <div class="">

                <p class="font-serif text-left break-words  md:text-sm text-xs"> {{publication.addresss}}</p>

                </div>

                 {% if publication.video %}

                <div class="grid grid-cols-1 justify-center justify-self-center">

                       <video
                        id="my-videow"
                        class="video-js vjs-default-skin vjs-big-play-centered w-full"
                        controls = "True"
                        preload="auto"



                        data-setup="{}">
                        <source src="{{ publication.video.url }}" />

                      </video>>
                </div>


                {% elif publication.img %}
                 <div class="">

                    <img        class = "max-h-72 max-w-full "
                                src="{{ publication.img.url }}">
                </div>

                {% elif publication.img2 %}
                 <div class="">

                <img        class = "max-h-72 max-w-full "

                            src="{{ publication.img2.url }}"
                            width="640"
                            height="240">
                </div>


                     {% elif publication.pdf %}

                <div class="text-center text-lg font-bold text-yellow-300">

                    <a href="{{publication.pdf.url}}">Documento PDF Adjunto <br> &#128196</a>

                </div>

                {% else %}

               <div class="">

                {{map|safe}}

               </div>

                {% endif %}

                <div class="">

                    {% for tag in publication.involved.all %}

                        <a href="{% url 'publicationtags' tag.slug %}" class = "text-yellow-200 md:text-base text-sm"> {{tag.name}}</a>

                    {% endfor %}
                </div>


                <div class="grid  grid-cols-1 text-gray-100">

                    <div class="text-center text-yellow-200">

                        {% if publication.img %}

                        <a href="{% url 'publicationwdetail' publication.pk %}"> <i class="fa fa-file-image-o"></i> </a>
                        {% endif %}
                        {% if publication.img2 %}
                        <a href="{% url 'publicationwdetail' publication.pk %}"> <i class="fa fa-file-image-o"></i> </a>

                        {% endif %}
                        {% if publication.video %}


                        <a href="{% url 'publicationwdetail' publication.pk %}"> <i class="fa fa-file-video-o"></i> </a>
                        {% endif %}

                        {% if publication.pdf %}

                        <a href="{% url 'publicationwdetail' publication.pk %}"> <i class="fa fa-file-pdf-o py-4"></i> </a>



                        {% endif %}

                        </div>


                </div>



            {% if publication.uname == request.user %}

            <div class="grid grid-cols-2  align-text-bottom">
                <a class="text-right px-2" href="{% url 'publicationwupdate' publication.id %}">
                    <button class = " py-1 rounded"><i class="fa fa-pencil-square-o  text-gray-300"></i></button>
                </a>
                <a class="text-left px-2" href="{% url 'publicationwdelete' publication.id %}">
                    <button class = " py-1 rounded"><i class="fa fa-trash text-gray-300"></i></button>
                </a>
            </div>
            {% endif %}

            </div>

        </section>
    {% endfor %}

    </div>

    <script src="//vjs.zencdn.net/7.10.2/video.min.js"></script>

                        <script src="https://unpkg.com/@popperjs/core@2.9.1/dist/umd/popper.min.js" charset="utf-8"></script>

                        <script>
                          function openPopover(event,popoverID){
                            let element = event.target;
                            while(element.nodeName !== "BUTTON"){
                              element = element.parentNode;
                            }
                            var popper = Popper.createPopper(element, document.getElementById(popoverID), {
                              placement: 'right'
                            });
                            document.getElementById(popoverID).classList.toggle("hidden");
                          }
                        </script>

{%endblock content%}
